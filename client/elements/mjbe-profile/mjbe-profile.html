<link rel="import" href="../../bower_components/iron-icons/social-icons.html">
<dom-module id="mjbe-profile">
  <template>
    <style>
      :host {
        display: block;
        padding: 15px;
        background: #444;
        height: calc(100% - 30px);
        min-height: 730px;  
      }
      paper-material {
        margin: 10px;
        padding: 10px;
      }
      .box {
        width: 500px;
        min-width: 300px;
      }
      .short-box {
        height: 100px;
      }
      .tall-box {
        height: 300px;
      }
      .square-box {
        height: 150px;
      }
      .really-tall-box {
        height: 490px;
      }
      .namebox {
        background: #333;
        color: #fff;
        height: 100px;
      }
      .heightfix {
        overflow: auto;
      }
      .invitation {
        background: #FFCC00;
        text-align: center;
      }
      paper-button {
        background: white;
        color: #007AFF;
      }
    </style>
    
    <!-- top bar only for pending teacher invitation -->
    <template is="dom-if" if="{{request}}">
    <div class="tile layout horizontal">
      <paper-material elevation="1" class="flex invitation heightfix">
          <h2>You got a class invitation from {{request.teacher.name}}!</h2>
          <p>{{request.class.name}}</p>
          <paper-button raised on-tap="acceptRequest"><iron-icon icon="social:group-add"></iron-icon> Click here to join the class</paper-button>
      </paper-material>
    </div>
    </template>

    <!-- whole grid -->
    <div class="bar horizontal layout around-justified wrap tile">

      <!-- first column -->
      <div class="box tile flex layout vertical">

        <paper-material elevation="4" class="namebox">
          <h2>{{name}}</h2>
          <p>Member since {{joined}}</p>
        </paper-material>

        <paper-material elevation="1" style="background-color: #5AC8FA" class="square-box">
          <h3>Date and Time</h3>
          <p>Member since {{joined}}</p>
        </paper-material>

        <paper-material elevation="1" style="background-color: #FF2D55" class="tall-box">
          <mjbe-updating-grid></mjbe-updating-grid>
        </paper-material>

      </div>

      <!-- second column -->
      <div class="box tile flex layout vertical">

        <paper-material elevation="1" style="background-color: white" class="short-box" >
          <h3>Latest Badge</h3>
        </paper-material>

        <paper-material elevation="1" style="background-color: #4CD964" class="really-tall-box">
          <mjbe-profile-pie userselection="{{userselection}}" loadskills="{{loadskills}}"  loadstudentskills="{{loadstudentskills}}"></mjbe-profile-pie>
        </paper-material>

      </div>

      <!-- third column -->
      <div class="box tile layout vertical flex">

        <paper-material elevation="1" style="background-color: white" class="short-box" >
          <h3>Latest Badge</h3>
        </paper-material>

        <paper-material elevation="1" style="background-color: #FF9500" class="tall-box">
          <h3>Another box</h3>
          <p>Member since April 1, 2017</p>
        </paper-material>
        
        <paper-material elevation="1" style="background-color: #5AC8FA" class="square-box">
          <h3>Date and Time</h3>
          <p>Member since April 1, 2017</p>
        </paper-material>
      </div>
    </div>
<!--     <div class="bar horizontal layout around-justified wrap tile">
      <div class="box tile layout flex">
        <paper-material elevation="1">
          <h3>Let's go</h3>
        </paper-material>
      </div>
      <div class="box tile layout flex">
        <paper-material elevation="1">
          <h4>Almost Halvzies</h4>
        </paper-material>
      </div>
    </div> -->

    
  </template>
  <script>
    Polymer({
      is: 'mjbe-profile',

      behaviors: [
        Polymer.NeonSharedElementAnimatableBehavior,
        Polymer.NeonAnimatableBehavior,
        Polymer.NeonAnimationRunnerBehavior
      ],

      properties: {
      //stringified version of raw class data
        // loadclasses: {
        //   type: String,
        //   notify: true
        // },
        loadrequest: {
          notify: true
        },

        request: {
          computed: 'parse(loadrequest)'
        },

        accepted: {
          notify: true
        },

        name: {
          notify: true
        },

        joined: {
          notify: true
        },

        userselection: {
          notify: true,
          observer: 'userselect'
        },

        loadskills: {
          notify: true
        },

        loadstudentskills: {
          notify: true
        },

        animationConfig: {
          type: Object,
          value: function() {
            return {
              'entry': [{
                name: 'cascaded-animation',
                animation: 'transform-animation',
                transformFrom: 'translateY(100%)',
                transformTo: 'none',
                timing: {
                  delay: 50
                }
              }]
              // 'toolbar': [{
              //   name: 'slide-down-animation',
              //   node: this.$.classSelect,
              //   timing: {
              //     delay: 50
              //   }
              // }]
            }
          }
        }
      },

      userselect: function() {
        console.log(this.userselection, 'this is the observer');
      },
    
      attached: function() {
        this.async(function() {
          var nodeList = Polymer.dom(this.root).querySelectorAll('.tile');
          this.animationConfig['entry'][0].nodes = Array.prototype.slice.call(nodeList);
          // this.playAnimation('toolbar');
          this.playAnimation('entry');
        });
      },

      parse: function(loadrequest) {
        try {
          return JSON.parse(loadrequest);
        } catch (e) {}
      },

      acceptRequest: function() {
        console.log('accepting in polymer');
        this.accepted = 'true';
      }
    });
  </script>
</dom-module>